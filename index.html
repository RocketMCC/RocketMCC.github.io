<!-- PWA install logic -->
<script>
(async ()=>{
  // Dynamically create and register manifest
  const manifest = {
    name: "RocketMCC",
    short_name: "RocketMCC",
    start_url: ".",
    display: "standalone",
    background_color: "#0d0d0d",
    theme_color: "#ff0000",
    icons: [
      { src: "https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/72x72/1f680.png", sizes: "72x72", type: "image/png" },
      { src: "https://cdn.jsdelivr.net/gh/twitter/twemoji@14.0.2/assets/128x128/1f680.png", sizes: "128x128", type: "image/png" }
    ]
  };
  const blob = new Blob([JSON.stringify(manifest)], { type: "application/json" });
  const manifestURL = URL.createObjectURL(blob);
  const link = document.createElement("link");
  link.rel = "manifest";
  link.href = manifestURL;
  document.head.appendChild(link);

  // Create and register service worker inline
  const swCode = `
    self.addEventListener('install', e => self.skipWaiting());
    self.addEventListener('fetch', e => {});
  `;
  const swBlob = new Blob([swCode], { type: "text/javascript" });
  const swURL = URL.createObjectURL(swBlob);
  if ('serviceWorker' in navigator) await navigator.serviceWorker.register(swURL);

  // Install button UI
  const installBtn = document.createElement("button");
  installBtn.textContent = "Install RocketMCC";
  installBtn.style = `
    position:fixed;bottom:20px;right:20px;padding:12px 20px;
    background:#ff0000;border:none;border-radius:10px;
    color:#fff;font-weight:bold;font-size:16px;
    cursor:pointer;box-shadow:0 0 15px rgba(255,0,0,0.5);
  `;
  installBtn.hidden = true;
  document.body.appendChild(installBtn);

  // Handle install prompt
  let deferredPrompt;
  window.addEventListener('beforeinstallprompt', (e)=>{
    e.preventDefault();
    deferredPrompt = e;
    installBtn.hidden = false;
  });
  installBtn.addEventListener('click', async ()=>{
    installBtn.hidden = true;
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      deferredPrompt = null;
    } else {
      alert("Use your browser menu â†’ 'Install App' to add RocketMCC.");
    }
  });
})();
</script>
